# 探究训练技巧对小样本检测的影响

## 摘要

​	最近在图像目标检测任务领域取的了很大进展，从2012年ALEXNET发布以来，神经网络成为提取图像语义特征的主要方式，随后提出的各种卷积神经网络成为提高目标检测准确率的主要手段。与此同时，伴随神经网络的丰富，各种各样的目标检测算法结构和数据增强方法也层出不穷，不同的目标检测结构配合不同的骨干网络提取图像特征能够达到意想不到的效果，神经网络的训练往往需要足够多的数据，有效的数据增强手段也为目标检测任务提供了不少帮助。本实验开始探究不同骨干网络、算法结构和数据增强手段，对小样本小目标logo检测的影响。同时我们希望它能推广到其他更多通用数据集上。

## 一、介绍

​	*自2012年发布AlexNet以来，深度卷积神经网络已经成为图像分类的主要方法。从那时起，各种新的架构被提出，包括VGG [24]、NiN [16]、inception[1]、ResNet [9]、DenseNet [13]和NASNet [35]。同时，我们也看到了模型精度提高的稳定趋势。例如，ImageNet [23]上的前1个验证精度已经从62.5%（AlexNet）提高到82.7%（NASNet-A）。*

​	*然而，这些进步并不仅仅来自于改进的骨干网络结构。训练过程的改进，包括损失函数的变化、数据预处理和优化的方法也发挥了主要作用。在过去的几年中，已经提出了大量这样的改进，但受到的关注相对较少。在文献中，大多数只是作为实现细节简要提到，而其他的只能在源代码中找到。*

​	*在本文中，我们将从提取特征的骨干网络、处理特征的算法结构和增强特征的数据增强三个方面。进行目标检测精度影响的探究。我们将在多个网络架构和数据集上评估它们，并报告它们对最终模型精度的影响。*

​	*我们在logo数据集中探究在小样本小目标数据中，不同方法改进对目标检测精度的影响。我们的实证评价表明，有几种技巧可以显著提高精度，并将它们结合在一起可以进一步提高模型的精度。在应用了所有技巧后，我们将ResNet-50与表1中的其他相关网络进行了比较。请注意，这些技巧将ReageNet上的ResNet-50前1的验证精度从75.3%提高到79.29%。它的性能也优于其他更新和改进的网络架构，如SE-ResNeXt-50。此外，我们还证明了我们的方法可以推广到其他网络（Inception V3 [1]和MobileNet [11]）和数据集（Place365 [33]）。我们进一步证明，用我们的技巧训练的模型在其他应用领域，如目标检测和语义分割，可以带来更好的迁移学习性能。*

## 二、相关工作

​	He在2019年分析了不同技巧在卷积神经网络中的提升，并证明这些技巧在目标检测和语义分割以及下游任务中依然有效，但是常规的数据集具有大量的样本，使用技巧也更倾向于大样本学习，我们希望能够探究在小样本学习中能够提升目标检测任务的技巧和方法。

​	数据集介绍：第一个数据集我们采用了 [ICME-2022 安全AI挑战者计划第九期：小样本商标检测挑战赛](https://tianchi.aliyun.com/competition/entrance/531948/introduction) 中的logo数据集。该数据集从openbrand数据模拟复赛分布，随机选取了50类，每类20张作为train, 20张作为val，train和val之间数据不重复。第二个数据集我们称为logodet59数据集，该数据集从Logodet-3k中挑选出超出150张样本图片的类，按照2：2：6切割训练集、验证集和测试集，平均训练集包含大约30~40张图片。

​	基本训练流程：

​	*算法1中给出了用小批量随机梯度下降训练神经网络的模板。在每次迭代中，我们随机抽取b幅图像来计算梯度，然后更新网络参数。它在通过了k次数据集后停止。算法1中的所有函数和超参数都可以用多种不同的方式来实现。在本节中，我们首先指定算法1的基线实现*

​	基本参数与控制变量方法



​	实验环境:3090

## 三、分析小样本检测中表征的影响

​	深度学习中通过卷积神经网络直接对图片进行表征提取，以供下游任务进行分类，检测或分割，神经网络提取特征的能力直接决定了后续任务的执行精度，从alexnet开始到swintransformer神经网络越来越深，在【】中证明了更深的神经网络可以更好的提取出更深层的语义特征，但是使用更深的神经网络同时需要更多的样本，在样本量小的情况下使用更深的神经网络，是否容易导致过拟合问题？是否更容易受到样本噪声的干扰 ？我们决定在不同的骨干网络中尝试，在小样本训练量的情况下不同的骨干网络泛化能力的表现。我们尝试在浅层神经网络（alexnet）、深度神经网络（resnet50和resnet108）、宽度神经网络（Google net）和带注意力机制的神经网络（Swin Transformer）中对比实验。

ResNet 50 是

logo比赛数据集

|                  |  mAP  |     flops     | Params  | 时间 |
| :--------------: | :---: | :-----------: | ------- | :--: |
|    ResNet 50     | 0.431 | 206.91 GFLOPs | 41.37 M |      |
|    ResNet 108    |       |               |         |      |
|    Google net    |       |               |         |      |
| Swin Transformer | 0.444 | 263.02 GFLOPs | 47.63 M |      |
|      CB Net      | 0.432 | 283.56 GFLOPs | 69.25 M |      |

logodet-59数据集

|                  |  mAP  |     flops     | Params  | 时间 |
| :--------------: | :---: | :-----------: | ------- | :--: |
|    ResNet 50     | 0.267 | 206.96 GFLOPs | 41.42 M |      |
| Swin Transformer | 0.286 | 263.25 GFLOPs | 47.68 M |      |
|      CB Net      | 0.274 | 283.56 GFLOPs | 69.25 M |      |

## 四、分析小样本检测中算法结构的影响

logo比赛数据集

|                              |  mAP  |      |
| :--------------------------: | :---: | ---- |
| Swin Transformer+faster RCNN | 0.444 |      |
|         cascade RPN          | 0.473 |      |
|         探究NWD再RPN         | 0.445 |      |
|          探究focal           | 0.455 |      |
|        FPN -> Dyhead         |       |      |
|                              |       |      |

logodet-59数据集

|                              |  mAP  |      |
| :--------------------------: | :---: | ---- |
| Swin Transformer+faster RCNN | 0.286 |      |
|         cascade RPN          | 0.31  |      |
|         探究NWD再RPN         | 0.247 |      |
|          探究focal           |       |      |
|        FPN -> Dyhead         |       |      |
|                              |       |      |

## 五、分析小样本检测中数据增强的影响

logo比赛数据集

|                |  mAP  |
| :------------: | :---: |
|      基线      | 0.444 |
|     大尺度     | 0.541 |
| yolox HSV 增强 |       |
|     mixup      |       |
|     mosaic     |       |
|   copy paste   |       |

logodet-59数据集

|            | mAP  |
| :--------: | :--: |
|    基线    |      |
|   大尺度   |      |
|   yolox    |      |
| corruption |      |
|   mixup    |      |
|   mosaic   |      |
| copy paste |      |

## 六、结论

参考文献

He T, Zhang Z, Zhang H, et al. Bag of tricks for image classification with convolutional neural networks[C]//Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. 2019: 558-567.

Wang J, Min W, Hou S, et al. Logodet-3k: A large-scale image dataset for logo detection[J]. ACM Transactions on Multimedia Computing, Communications, and Applications (TOMM), 2022, 18(1): 1-19.